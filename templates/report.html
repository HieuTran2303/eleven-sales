<!DOCTYPE html>
<html>
<head>
  <title>Monthly Report</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body class="p-4 bg-light">
<div class="container">
  <h1 class="mb-4">ðŸ“Š Sales Report for {{ month }}</h1>

  {% if sales %}
    <table class="table table-striped">
      <thead><tr>
        <th>Date</th><th>Item</th><th>Qty</th><th>Price</th><th>Total</th>
      </tr></thead>
      <tbody>
      {% for s in sales %}
        <tr>
          <td>{{ s.date }}</td>
          <td>{{ s.item }}</td>
          <td>{{ s.quantity }}</td>
          <td>{{ s.price }}</td>
          <td>{{ s.total }}</td>
        </tr>
      {% endfor %}
      </tbody>
    </table>

    <p><strong>ðŸ§¾ Total:</strong> ${{ total }}</p>
    <a class="btn btn-success" href="/export?month={{ month }}">ðŸ“¥ Download Excel</a>
    <a class="btn btn-secondary" href="/">â¬… Back</a>

    <hr>
    <h3>ðŸ“ˆ Daily Sales Chart</h3>
    <canvas id="salesChart"></canvas>

    <script>
      const ctx = document.getElementById('salesChart').getContext('2d');
      const salesChart = new Chart(ctx, {
        type: 'bar',
        data: {
          labels: {{ chart_data.keys()|list }},
          datasets: [{
            label: 'Daily Total ($)',
            data: {{ chart_data.values()|list }},
            backgroundColor: 'rgba(54, 162, 235, 0.7)',
            borderRadius: 5
          }]
        },
        options: {
          responsive: true,
          scales: {
            y: {
              beginAtZero: true
            }
          }
        }
      });
    </script>

  {% else %}
    <p>No sales found for {{ month }}</p>
  {% endif %}
</div>
</body>
</html>
